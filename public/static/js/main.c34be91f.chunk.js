(window.webpackJsonpmy_bookinga_app=window.webpackJsonpmy_bookinga_app||[]).push([[0],{25:function(e,t,n){e.exports=n(47)},30:function(e,t,n){},31:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(17),s=n.n(r),o=(n(30),n(3)),u=n(4),l=n(7),c=n(6),p=n(8),m=n(11),h=(n(31),n(5)),d=n(1),v=n.n(d),f=n(2),b=(n(33),function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(c.a)(t).call(this))).close=e.close.bind(Object(h.a)(e)),e.maybeClose=e.maybeClose.bind(Object(h.a)(e)),e.submitLogin=e.submitLogin.bind(Object(h.a)(e)),e.submitRegister=e.submitRegister.bind(Object(h.a)(e)),e}return Object(p.a)(t,e),Object(u.a)(t,[{key:"close",value:function(){try{document.getElementById("PopupShadow").click(),document.getElementById("loginForm").style.display="none"}catch(e){}}},{key:"maybeClose",value:function(e){"FORM"===e.target.tagName?this.close():e.preventDefault()}},{key:"submitLogin",value:function(){var e=Object(f.a)(v.a.mark((function e(t){var n,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=document.getElementById("username").value,a=document.getElementById("password").value,document.getElementById("password").value="",e.next=6,this.props.BioApi.login(n,a);case 6:if(!e.sent){e.next=10;break}this.close(),e.next=11;break;case 10:alert("Login faild");case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"submitRegister",value:function(){var e=Object(f.a)(v.a.mark((function e(t){var n,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=document.getElementById("username").value,a=document.getElementById("password").value,document.getElementById("password").value="",e.next=6,this.props.BioApi.register(n,a);case 6:if(!e.sent){e.next=10;break}this.props.onClose(t),e.next=11;break;case 10:alert("Register faild");case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return i.a.createElement("form",{id:"loginForm",method:"post",onClick:this.maybeClose},i.a.createElement("div",{id:"Login"},i.a.createElement("p",null,"Login"),i.a.createElement("label",null,i.a.createElement("span",null,"Username:"),i.a.createElement("input",{id:"username",type:"text",name:"username"})),i.a.createElement("label",null,i.a.createElement("span",null,"Password:"),i.a.createElement("input",{id:"password",type:"password",name:"password"})),i.a.createElement("label",null,i.a.createElement("input",{type:"submit",value:"Register",onClick:this.submitRegister}),i.a.createElement("input",{type:"submit",value:"Login",onClick:this.submitLogin})),i.a.createElement("span",{id:"LoginClose",onClick:this.close},"X")))}}]),t}(i.a.Component)),g=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(c.a)(t).call(this))).popupShadow=null,e.state={popupShadow:e.popupShadow},e}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){null==this.popupShadow&&(this.popupShadow=document.getElementById("PopupShadow"),null!=this.popupShadow&&this.setState({popupShadow:this.popupShadow}))}},{key:"render",value:function(){return null==this.popupShadow&&(this.popupShadow=document.getElementById("PopupShadow"),null==this.popupShadow)?"":s.a.createPortal(this.props.children,this.popupShadow)}}]),t}(i.a.Component),y=(n(34),function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(c.a)(t).call(this))).state={logedin:!1},e.showLogin=e.showLogin.bind(Object(h.a)(e)),e.logout=e.logout.bind(Object(h.a)(e)),e.loginUppdate=e.loginUppdate.bind(Object(h.a)(e)),e}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.props.BioApi.addListener(this.loginUppdate),this.props.BioApi.islogedin()&&this.setState({logedin:!0})}},{key:"showLogin",value:function(){document.getElementById("loginForm").style.display="flex",document.getElementById("PopupShadow").style.display="block"}},{key:"logout",value:function(){this.props.BioApi.logout()}},{key:"loginUppdate",value:function(e){this.setState({logedin:e})}},{key:"render",value:function(){return i.a.createElement("header",{id:"MenuHedder"},i.a.createElement("h1",null,"KID CINEMA!"),i.a.createElement(m.c,{to:"/movies",activeClassName:"active"},"Movies"),i.a.createElement(m.c,{to:"/info",activeClassName:"active"},"Info"),this.state.logedin?i.a.createElement(i.a.Fragment,null,i.a.createElement(m.c,{to:"/mybookings",activeClassName:"active"},"My Bookings"),i.a.createElement("span",{onClick:this.logout},"Logout")):i.a.createElement(i.a.Fragment,null,i.a.createElement("span",{onClick:this.showLogin},"Login"),i.a.createElement(g,null,i.a.createElement(b,{BioApi:this.props.BioApi}))))}}]),t}(i.a.Component)),k=n(14),w=(n(40),function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={cinemas:[]},n.uppdateSort=n.uppdateSort.bind(Object(h.a)(n)),n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=Object(f.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.BioApi.cinemas();case 2:t=e.sent,this.setState({cinemas:t});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"uppdateSort",value:function(){var e={};e.date=document.getElementById("Filterdate").value,e.cinema=document.getElementById("Filtercinema").value,e.age=document.getElementById("Filterage").value,this.props.onChange(e)}},{key:"render",value:function(){var e=[i.a.createElement("option",{value:"All"},"Date: All")],t=new Date((new Date).toDateString());e.push(i.a.createElement("option",{value:t.getTime()},"Today: ",t.getDate(),"/",t.getMonth()+1));var n=new Date(t);n.setDate(n.getDate()+1),e.push(i.a.createElement("option",{value:n.getTime()},"Tomorrow: ",n.getDate(),"/",n.getMonth()+1));for(var a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],r=0;r<=5;r++)n.setDate(n.getDate()+1),e.push(i.a.createElement("option",{value:n.getTime()},a[n.getDay()],": ",n.getDate(),"/",n.getMonth()+1));var s=[i.a.createElement("option",{value:"All"},"All Cinemas")],o=!0,u=!1,l=void 0;try{for(var c,p=this.state.cinemas[Symbol.iterator]();!(o=(c=p.next()).done);o=!0){var m=c.value;s.push(i.a.createElement("option",{value:m.id},m.name))}}catch(d){u=!0,l=d}finally{try{o||null==p.return||p.return()}finally{if(u)throw l}}var h=[i.a.createElement("option",{value:"baby"},"Age: All"),i.a.createElement("option",{value:"baby"},"Age: 0-6"),i.a.createElement("option",{value:"kid"},"Age: 7-15")];return null!=this.props.movie&&(h=[i.a.createElement("option",{value:"baby"},"Age: ",this.props.movie.age_limit)]),i.a.createElement("div",{className:"DateSort"},i.a.createElement("div",null,i.a.createElement("select",{id:"Filterdate",onChange:this.uppdateSort},e),i.a.createElement("select",{id:"Filtercinema",onChange:this.uppdateSort},s),i.a.createElement("select",{id:"Filterage",onChange:this.uppdateSort},h)))}}]),t}(i.a.Component)),E=(n(41),function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={movies:[]},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=Object(f.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.BioApi.movies();case 2:t=e.sent,this.setState({movies:t});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderOneMoive",value:function(e){return i.a.createElement("div",{className:"MovieHolder"},i.a.createElement("div",null,i.a.createElement("img",{src:e.image_url,alt:"Movie poster",onClick:function(e){return e.currentTarget.parentElement.parentElement.children[1].click()}})),i.a.createElement(m.b,{to:"/movie/"+e.id},e.title))}},{key:"uppdateSort",value:function(e){console.log("B:",e)}},{key:"render",value:function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"MovieGrid"},this.state.movies.map(this.renderOneMoive)))}}]),t}(i.a.Component)),O=(n(42),function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(c.a)(t).call(this))).uppdatePrice=e.uppdatePrice.bind(Object(h.a)(e)),e.submit=e.submit.bind(Object(h.a)(e)),e.close=e.close.bind(Object(h.a)(e)),e.maybeClose=e.maybeClose.bind(Object(h.a)(e)),e}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=Object(f.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.BioApi.wait();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"close",value:function(){document.getElementById("PopupShadow").click(),this.props.onClose()}},{key:"maybeClose",value:function(e){"FORM"===e.target.tagName&&this.close()}},{key:"uppdatePrice",value:function(){var e=this.props.show,t=+document.getElementById("ticketCount").value,n=e.seat_price*t,a=document.getElementById("ticketsPrice");console.log(a),a.innerText=n}},{key:"submit",value:function(){var e=Object(f.a)(v.a.mark((function e(t){var n,a,i,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=this.props.show.id,a=+document.getElementById("ticketCount").value,i=this.props.BioApi.islogedin(),e.prev=4,!i){e.next=10;break}return e.next=8,this.props.BioApi.addBookingCurrentUSer(n,a);case 8:e.next=13;break;case 10:return r=document.getElementById("email").value,e.next=13,this.props.BioApi.addBookingNewUser(n,a,r);case 13:e.next=19;break;case 15:return e.prev=15,e.t0=e.catch(4),alert("Booking fail"),e.abrupt("return");case 19:this.close(),alert("Bookings OK");case 21:case"end":return e.stop()}}),e,this,[[4,15]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.movie,t=this.props.show,n=t.auditorium,a=this.props.BioApi.cinema(n.cinema_id),r=new Date(t.start_at),s=this.props.BioApi.islogedin(),o=this.props.BioApi.email();return console.log("Email:",o),i.a.createElement("form",{id:"BookingForm",onClick:this.maybeClose,onSubmit:this.submit},i.a.createElement("div",{id:"Booking"},i.a.createElement("h3",null,"Book tickets"),i.a.createElement("p",null,i.a.createElement("strong",null,e.title),i.a.createElement("span",null,r.toISOString().slice(11,16)," ",r.toISOString().slice(0,10)),i.a.createElement("span",null,a.name," ",n.name),i.a.createElement("span",null,t.spoken_language," | Subtitle: ",t.subtitle_language)),i.a.createElement("label",null,i.a.createElement("span",null,"Number of tickets: "),i.a.createElement("input",{id:"ticketCount",name:"ticketCount",type:"number",min:"1",max:"10",onChange:this.uppdatePrice}),i.a.createElement("span",null,i.a.createElement("span",{id:"ticketsPrice"},t.seat_price),"\xa0SEK")),i.a.createElement("label",null,i.a.createElement("span",null,"Email:"),s?i.a.createElement("input",{id:"email",name:"email",type:"email",value:o,readOnly:!0}):i.a.createElement("input",{id:"email",name:"email",type:"email"})),i.a.createElement("label",null,i.a.createElement("input",{type:"checkbox",value:"byRulse",required:!0}),i.a.createElement("span",null,"I have read and agree with the ",i.a.createElement("a",{target:"_blank",href:"/Aggrement.pdf"},"terms and conditions"))),i.a.createElement("label",null,i.a.createElement("input",{type:"checkbox",value:"byAge",required:!0}),i.a.createElement("span",null,"I am 15 years of age or older.")),i.a.createElement("label",null,i.a.createElement("input",{type:"submit",value:"validate"})),i.a.createElement("span",{id:"BookingClose",onClick:this.close},"X")))}}]),t}(i.a.Component)),S=(n(43),function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={bookingShow:null,movieid:0,shows:[],filterShows:[],filterDate:"All",filterCinema:"All"},n.loadShows=n.loadShows.bind(Object(h.a)(n)),n.showBooking=n.showBooking.bind(Object(h.a)(n)),n.renderOneShow=n.renderOneShow.bind(Object(h.a)(n)),n.hideBooking=n.hideBooking.bind(Object(h.a)(n)),n.uppdateSort=n.uppdateSort.bind(Object(h.a)(n)),n.filterShows=n.filterShows.bind(Object(h.a)(n)),n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"loadShows",value:function(){var e=Object(f.a)(v.a.mark((function e(t){var n,a,i,r,s,o,u,l,c,p,m,h,d,f,b,g,y,k,w,E,O,S,j,x,B,A,C,D,I,_,M,L,P;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.BioApi.shows(t);case 2:return n=e.sent,e.next=5,this.props.BioApi.auditoriums();case 5:return a=e.sent,e.next=8,this.props.BioApi.cinemas();case 8:for(i=e.sent,r=!0,s=!1,o=void 0,e.prev=12,u=n[Symbol.iterator]();!(r=(l=u.next()).done);r=!0)(c=l.value).startDate=new Date(c.start_at),c.startTime=c.startDate.getTime();e.next=20;break;case 16:e.prev=16,e.t0=e.catch(12),s=!0,o=e.t0;case 20:e.prev=20,e.prev=21,r||null==u.return||u.return();case 23:if(e.prev=23,!s){e.next=26;break}throw o;case 26:return e.finish(23);case 27:return e.finish(20);case 28:p=!0,m=!1,h=void 0,e.prev=31,d=a[Symbol.iterator]();case 33:if(p=(f=d.next()).done){e.next=57;break}for(b=f.value,g=!0,y=!1,k=void 0,e.prev=38,w=n[Symbol.iterator]();!(g=(E=w.next()).done);g=!0)(O=E.value).auditorium_id===b.id&&(O.auditorium=b);e.next=46;break;case 42:e.prev=42,e.t1=e.catch(38),y=!0,k=e.t1;case 46:e.prev=46,e.prev=47,g||null==w.return||w.return();case 49:if(e.prev=49,!y){e.next=52;break}throw k;case 52:return e.finish(49);case 53:return e.finish(46);case 54:p=!0,e.next=33;break;case 57:e.next=63;break;case 59:e.prev=59,e.t2=e.catch(31),m=!0,h=e.t2;case 63:e.prev=63,e.prev=64,p||null==d.return||d.return();case 66:if(e.prev=66,!m){e.next=69;break}throw h;case 69:return e.finish(66);case 70:return e.finish(63);case 71:S=!0,j=!1,x=void 0,e.prev=74,B=i[Symbol.iterator]();case 76:if(S=(A=B.next()).done){e.next=100;break}for(C=A.value,D=!0,I=!1,_=void 0,e.prev=81,M=n[Symbol.iterator]();!(D=(L=M.next()).done);D=!0)(P=L.value).auditorium.cinema_id===C.id&&(P.cinema=C);e.next=89;break;case 85:e.prev=85,e.t3=e.catch(81),I=!0,_=e.t3;case 89:e.prev=89,e.prev=90,D||null==M.return||M.return();case 92:if(e.prev=92,!I){e.next=95;break}throw _;case 95:return e.finish(92);case 96:return e.finish(89);case 97:S=!0,e.next=76;break;case 100:e.next=106;break;case 102:e.prev=102,e.t4=e.catch(74),j=!0,x=e.t4;case 106:e.prev=106,e.prev=107,S||null==B.return||B.return();case 109:if(e.prev=109,!j){e.next=112;break}throw x;case 112:return e.finish(109);case 113:return e.finish(106);case 114:this.setState({movieid:t,shows:n}),this.state.shows=n,this.filterShows();case 117:case"end":return e.stop()}}),e,this,[[12,16,20,28],[21,,23,27],[31,59,63,71],[38,42,46,54],[47,,49,53],[64,,66,70],[74,102,106,114],[81,85,89,97],[90,,92,96],[107,,109,113]])})));return function(t){return e.apply(this,arguments)}}()},{key:"showBooking",value:function(e){var t=+e.currentTarget.getAttribute("data-show-id"),n=null,a=!0,i=!1,r=void 0;try{for(var s,o=this.state.shows[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var u=s.value;if(u.id===t){n=u;break}}}catch(c){i=!0,r=c}finally{try{a||null==o.return||o.return()}finally{if(i)throw r}}if(null!==n){this.setState({bookingShow:n});var l=document.getElementById("BookingForm");l&&(l.style.display="flex"),document.getElementById("PopupShadow").style.display="block"}}},{key:"hideBooking",value:function(){this.setState({bookingShow:null})}},{key:"uppdateSort",value:function(e){this.setState({filterDate:e.date,filterCinema:e.cinema}),this.state.filterDate=e.date,this.state.filterCinema=e.cinema,this.filterShows()}},{key:"filterShows",value:function(){var e=[],t=0,n=1/0;"All"===this.state.filterDate?t=new Date((new Date).toDateString()).getTime():n=(t=+this.state.filterDate)+9e7,console.log("DateRage:",[t,n]);var a=!0,i=!1,r=void 0;try{for(var s,o=this.state.shows[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var u=s.value;u.startTime<t||u.startTime>n||(console.log("DateMatch:",[t,u.startTime,n]),"All"!==this.state.filterCinema&&+this.state.filterCinema!==u.cinema.id||e.push(u))}}catch(l){i=!0,r=l}finally{try{a||null==o.return||o.return()}finally{if(i)throw r}}this.setState({filterShows:e})}},{key:"renderOneShow",value:function(e){var t=e.startDate;return i.a.createElement("li",null,i.a.createElement("span",{title:t.toISOString().slice(0,10)},t.toISOString().slice(11,16),i.a.createElement("br",null),t.getDate(),"/",t.getMonth()+1),i.a.createElement("span",null,i.a.createElement("strong",null,e.cinema.name," ",e.auditorium.name),i.a.createElement("br",null),i.a.createElement("span",null,e.spoken_language," | Subtitle:\xa0",e.subtitle_language)),i.a.createElement("span",null,i.a.createElement("span",null,e.seats_left," seats left"),i.a.createElement("button",{className:"BookingButton","data-show-id":e.id,onClick:this.showBooking},"Too Booking")))}},{key:"render",value:function(){var e=this.props.match.params.id;return e&&this.state.movieid!==e&&this.loadShows(e),i.a.createElement(i.a.Fragment,null,i.a.createElement(w,{movie:this.props.movie,BioApi:this.props.BioApi,onChange:this.uppdateSort}),i.a.createElement("ul",{className:"Showlist"},this.state.filterShows.map(this.renderOneShow)),i.a.createElement(g,null,null!==this.state.bookingShow?i.a.createElement(O,{BioApi:this.props.BioApi,movie:this.props.movie,show:this.state.bookingShow,onClose:this.hideBooking}):""))}}]),t}(i.a.Component)),j=Object(k.g)(S),x=(n(44),function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={movieid:0,movie:null},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"loadMovie",value:function(){var e=Object(f.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.BioApi.movie(t);case 2:n=e.sent,this.setState({movieid:t,movie:n});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.match.params.id;return e&&this.state.movieid!==e&&this.loadMovie(e),this.state.movie?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{id:"MovieInfo"},i.a.createElement("img",{id:"MovePicture",alt:"movie poster",src:this.state.movie.image_url}),i.a.createElement("div",{id:"MovieTitle"},i.a.createElement("h1",null,this.state.movie.title),i.a.createElement("label",null,"Age: ",this.state.movie.age_limit," |\xa0 Time: ",this.state.movie.length," |\xa0",this.state.movie.language," |\xa0",this.state.movie.category))),i.a.createElement("div",{id:"MovieText"},this.state.movie.description),i.a.createElement(j,{movie:this.state.movie,BioApi:this.props.BioApi})):i.a.createElement("p",null,"Loading")}}]),t}(i.a.Component)),B=Object(k.g)(x),A=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("h1",null,"Tuffs Bio!"),i.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed rhoncus faucibus scelerisque. Nulla molestie risus velit, quis dapibus eros hendrerit nec. Aliquam quis felis eu nulla dignissim scelerisque. Donec imperdiet quam non cursus congue. Aenean fringilla nulla vel ipsum suscipit tempus. Pellentesque vitae nisi ante. Nunc interdum, nibh ut pellentesque dignissim, nibh mi tincidunt ligula, et auctor ipsum leo eget arcu. Sed sed magna sem. Duis luctus at metus venenatis eleifend. Mauris sit amet velit magna. Mauris sollicitudin, diam vel volutpat tincidunt, augue metus facilisis ipsum, eu commodo elit nulla pretium massa. Nam ac quam sagittis, fermentum nunc eget, commodo lacus. Nullam in facilisis arcu, vel ultricies metus. Nam non lectus ut est ullamcorper varius. Duis dapibus accumsan tempor. Duis finibus ac risus ac commodo. In hac habitasse platea dictumst. Nam sit amet venenatis nisl. Proin tellus dui, tempus sit amet pulvinar nec, mattis non urna. Phasellus lectus nisl, dignissim id egestas vel, facilisis a dolor. Mauris fringilla nec elit in consectetur. Pellentesque euismod et turpis nec tempor. Sed at tempor tortor, nec hendrerit massa. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Vestibulum dictum non nisi sit amet aliquet. Etiam sodales tempus velit, ut interdum mi tempor in. Donec dapibus bibendum purus, ac euismod tortor feugiat eu. Aenean eget libero pellentesque, posuere massa quis, ornare sem. Vivamus lobortis sem a euismod fermentum. Donec purus arcu, posuere quis facilisis a, condimentum pulvinar eros. Nullam vitae faucibus massa. Phasellus sed lorem quis nunc blandit tincidunt."))}}]),t}(i.a.Component),C=(n(45),function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={reservations:[],logedin:!1},n.loginUppdate=n.loginUppdate.bind(Object(h.a)(n)),n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=Object(f.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.props.BioApi.addListener(this.loginUppdate),this.props.BioApi.islogedin()&&this.uppdateReservations();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"uppdateReservations",value:function(){var e=Object(f.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.props.BioApi.reservations();case 3:return t=e.sent,e.next=6,this.props.BioApi.wait();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),alert("Faild to load reservations");case 11:console.log("reserv",t),t&&(t=t.reverse(),this.setState({reservations:t}));case 13:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"loginUppdate",value:function(e){this.setState({logedin:e})}},{key:"renderOneBooking",value:function(e){var t=e.show,n=t.movie,a=this.props.BioApi.auditorium(t.auditorium_id),r=this.props.BioApi.cinema(a.cinema_id),s=new Date(t.start_at);return i.a.createElement("li",null,i.a.createElement("img",{src:n.image_url,alt:"Movie poster"}),i.a.createElement("div",null,i.a.createElement("h3",null,n.title),i.a.createElement("div",null,i.a.createElement("span",null,r.name," - ",a.name," - ",e.show.spoken_language),i.a.createElement("span",null,"Seats: ",e.first_seat_number," - ",e.first_seat_number+e.seat_count-1)),i.a.createElement("div",null,i.a.createElement("span",null,s.toISOString().slice(11,16)," - ",s.toISOString().slice(0,10)),i.a.createElement("span",null,"Price: ",e.show.seat_price*e.seat_count))))}},{key:"render",value:function(){return this.props.BioApi.islogedin()?i.a.createElement(i.a.Fragment,null,i.a.createElement("h2",null,"Your Bookings"),i.a.createElement("ul",{className:"Bookinglist"},this.state.reservations.map(this.renderOneBooking.bind(this)))):i.a.createElement(k.a,{to:"/movies"})}}]),t}(i.a.Component)),D=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{id:"ContentBox"},i.a.createElement(k.d,null,i.a.createElement(k.a,{exact:!0,from:"/",to:"/movies"}),i.a.createElement(k.b,{path:"/movies"},i.a.createElement(E,{BioApi:this.props.BioApi})),i.a.createElement(k.b,{path:"/movie/:id"},i.a.createElement(B,{BioApi:this.props.BioApi})),i.a.createElement(k.b,{path:"/info"},i.a.createElement(A,null)),i.a.createElement(k.b,{path:"/mybookings"},i.a.createElement(C,{BioApi:this.props.BioApi})),i.a.createElement(k.b,null,"404")))}}]),t}(i.a.Component),I=function(){function e(){var t=this;Object(o.a)(this,e),this.conction="https://bio.tuffsruffs.se/api/",this.auditoriumsPromis=null,this.auditoriumsList=[],this.cinemasPromis=null,this.cinemasList=[],this.logedin=!1,this.eventFunctions=[],this.user=null,this.auditoriumsPromis=this.getJson("auditoriums"),this.auditoriumsPromis.then((function(e){return t.auditoriumsList=e})),this.cinemasPromis=this.getJson("cinemas"),this.cinemasPromis.then((function(e){return t.cinemasList=e}));var n=JSON.parse(localStorage.getItem("token"));n&&(this.logedin=!0,this.user=n)}return Object(u.a)(e,[{key:"wait",value:function(){var e=Object(f.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.auditoriumsPromis;case 2:return e.next=4,this.cinemasPromis;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getJson",value:function(){var e=Object(f.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.conction+t);case 2:if(!((n=e.sent).status<200||n.status>=300)){e.next=9;break}return e.t0=Error,e.next=7,n.text();case 7:throw e.t1=e.sent,new e.t0(e.t1);case 9:return e.abrupt("return",n.json());case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"postJson",value:function(){var e=Object(f.a)(v.a.mark((function e(t,n){var a,i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"POST",body:n},e.next=3,fetch(this.conction+t,a);case 3:if(!((i=e.sent).status<200||i.status>=300)){e.next=10;break}return e.t0=Error,e.next=8,i.text();case 8:throw e.t1=e.sent,new e.t0(e.t1);case 10:return e.abrupt("return",i.json());case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"postString",value:function(){var e=Object(f.a)(v.a.mark((function e(t,n){var a,i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"POST",body:n},e.next=3,fetch(this.conction+t,a);case 3:if(!((i=e.sent).status<200||i.status>=300)){e.next=10;break}return e.t0=Error,e.next=8,i.text();case 8:throw e.t1=e.sent,new e.t0(e.t1);case 10:return e.abrupt("return",i.text());case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"movies",value:function(){var e=Object(f.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getJson("movies"));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"movie",value:function(){var e=Object(f.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getJson("movie/"+t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"auditoriums",value:function(){return this.auditoriumsList}},{key:"auditorium",value:function(e){var t=!0,n=!1,a=void 0;try{for(var i,r=this.auditoriumsList[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var s=i.value;if(e===s.id)return s}}catch(o){n=!0,a=o}finally{try{t||null==r.return||r.return()}finally{if(n)throw a}}return null}},{key:"cinemas",value:function(){return this.cinemasList}},{key:"cinema",value:function(e){var t=!0,n=!1,a=void 0;try{for(var i,r=this.cinemasList[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var s=i.value;if(e===s.id)return s}}catch(o){n=!0,a=o}finally{try{t||null==r.return||r.return()}finally{if(n)throw a}}return null}},{key:"shows",value:function(){var e=Object(f.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getJson("movie/"+t+"/shows"));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"islogedin",value:function(){return this.logedin}},{key:"email",value:function(){return this.user?this.user.email:""}},{key:"login",value:function(){var e=Object(f.a)(v.a.mark((function e(t,n){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new FormData).append("email",t),a.append("password",n),e.prev=3,e.next=6,this.postJson("login",a);case 6:this.user=e.sent,e.next=12;break;case 9:return e.prev=9,e.t0=e.catch(3),e.abrupt("return",!1);case 12:return this.logedin=!0,localStorage.setItem("token",JSON.stringify(this.user)),this.triggerListener(),e.abrupt("return",this.logedin);case 16:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"register",value:function(){var e=Object(f.a)(v.a.mark((function e(t,n){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new FormData).append("email",t),a.append("password",n),e.prev=3,e.next=6,this.postJson("register",a);case 6:this.user=e.sent,e.next=12;break;case 9:return e.prev=9,e.t0=e.catch(3),e.abrupt("return",!1);case 12:return this.logedin=!0,localStorage.setItem("token",JSON.stringify(this.user)),this.triggerListener(),e.abrupt("return",this.logedin);case 16:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"reservations",value:function(){var e=Object(f.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new FormData).append("token",this.user.token),e.prev=2,e.abrupt("return",this.postJson("reservations",t));case 6:return e.prev=6,e.t0=e.catch(2),e.abrupt("return",[]);case 9:case"end":return e.stop()}}),e,this,[[2,6]])})));return function(){return e.apply(this,arguments)}}()},{key:"addBookingCurrentUSer",value:function(){var e=Object(f.a)(v.a.mark((function e(t,n){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new FormData).append("token",this.user.token),a.append("show_id",t),a.append("seats",n),e.abrupt("return",this.postJson("book",a));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"addBookingNewUser",value:function(){var e=Object(f.a)(v.a.mark((function e(t,n,a){var i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=new FormData).append("email",a),i.append("show_id",t),i.append("seats",n),e.abrupt("return",this.postJson("book",i));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"logout",value:function(){this.logedin=!1,this.user=null,localStorage.removeItem("token"),this.triggerListener()}},{key:"addListener",value:function(e){this.eventFunctions.push(e)}},{key:"triggerListener",value:function(){var e=!0,t=!1,n=void 0;try{for(var a,i=this.eventFunctions[Symbol.iterator]();!(e=(a=i.next()).done);e=!0){(0,a.value)(this.logedin)}}catch(r){t=!0,n=r}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}}]),e}(),_=(n(46),function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"close",value:function(){document.getElementById("PopupShadow").style.display="none"}},{key:"render",value:function(){return i.a.createElement("div",{id:"PopupShadow",onClick:this.close})}}]),t}(i.a.Component)),M=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(c.a)(t).call(this))).api=new I,e.state={pageToDisplay:"HOME"},e}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return i.a.createElement(m.a,null,i.a.createElement(y,{Logedin:!0,BioApi:this.api}),i.a.createElement(D,{BioApi:this.api}),i.a.createElement(_,{BioApi:this.api}))}}]),t}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(M,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[25,1,2]]]);
//# sourceMappingURL=main.c34be91f.chunk.js.map